$(document).ready(function(){function e(){s(),i={beforeGame:!0,whileGame:!1,afterGame:!1},l={id:"one",maxCoins:6,direction:"up",moves:20,currentCoins:0,row:[],coins:[{}]},r={},$("#menu p").text(l.moves),$(".field").addClass("nope").removeClass("choice"),console.clear(),f(i)}var o=function(e){var o=[],n=e[0];for(var i in n)n.hasOwnProperty(i)&&o.push(n[i]);return console.log("out:"+o),o},n=function(e,o){var n;array_elements=e,array_elements.sort();for(var i=null,r=0,l=0;l<array_elements.length;l++)if(array_elements[l]!=i){if(r>0&&i==o)return n=r;i=array_elements[l],r=1}else r++;return r>0&&i==o?n=r:void 0};$("#reset").click(function(){e()});var i,r,l,c=function(e,o){var n=document.createElement("div");n.setAttribute("class","coin "+o.id),n.player=o.id,$(".row:nth-child("+e.row+") .field:nth-child("+e.field+")").append(n)},a=function(e,o){if($condition=!0,1==i.whileGame&&($condition=!1),r.parent.hasClass("nope")||($condition=!1),o.currentCoins===o.maxCoins&&($condition=!1,i.beforeGame=!1,i.whileGame=!0,f(i)),-1!=$.inArray(r.row,o.row)&&0==i.whileGame&&($condition=!1,console.log("One Coin in the row")),$condition===!0){o.currentCoins++,o.row.push(r.row),o.coins[0][r.row-1]=r.field,o.moves-=r.field,$("#menu p").text(o.moves+" / 20");var n="#row-"+r.row;$(n).addClass("used");var l=60-10*o.currentCoins,a=6-o.currentCoins-1,t=o.moves-a;$(".nope").removeClass("nope"),$(".row").each(function(e){var n=e+1;-1!=$.inArray(n,o.row)||$(".row:nth-child("+n+") .field:lt("+t+")").addClass("nope")}),c(r,o)}},t=function(e){return r.parent=e,r.row=parseFloat(e.parent().index()+1),r.field=parseFloat(e.index()+1),console.log("$actions.field: "+r.field),1==i.whileGame,r},s=function(){$(".coin").remove(),$(".row").removeClass("used")},d=function(e){var o=r.field+e,n=r.field-e;if(10>=o){var i=$(".row:nth-child("+r.row+") .field:nth-child("+o+")");i.addClass("choice-up")}if(n>0){var c=$(".row:nth-child("+r.row+") .field:nth-child("+n+")");c.addClass("choice-down")}$(".field.choice-up").click(function(){l.row[r.row]=o}),$(".field.choice-down").click(function(){l.row[r.row]=n})},f=function(e){$(".field").click(function(){if(1==e.beforeGame&&0==e.whileGame&&(console.log("beforeGame"),a(t($(this)),l)),1==e.whileGame){var i=$(this).has(".coin").length,s=$(this).is(".choice-up, .choice-down");if(console.log(i),i>0){console.log("whileGame"),t($(this)),console.log("$player.coins: "+l.coins),l.row=o(l.coins);var f=n(l.row,r.field);d(f)}if(!s)return!1;var h=$(this).index()+1,w=l.row[r.row];$(".row:nth-child("+r.row+") .field:nth-child("+w+")").remove("coin"),l.row[r.row]=h,console.log(r,l),c(r,l),console.log("du bist dabei auf feld "+h+" zu springen")}else console.log("dount")})};window.onload=e});